<%- include('../partials/header') %>

<div class="flex flex-col md:flex-row flex-wrap justify-center">
    <% genres.forEach(genre => { %>
        <% let filteredBooks = books.filter(book => book.genre === genre && !book.haveRead); %>
        <% if (filteredBooks.length > 0) { %>
            <div class="fkex-col">
                <h2 class="text-white text-center mb-4 mt-4 text-3xl font-extrabold leading-none tracking-tight"><%= genre %></h2>
                <ul class="mt-3">
                    <% filteredBooks.forEach(book => { %>
                        <li class="text-center bg-gray-800 rounded w-2/3 mx-auto p-3 mb-3 h-fit md:w-60 md:mr-5 md:h-80 md:max-w-2/3">
                            <a href="/books/<%= book._id %>" class="text-white"><%= book.title %>
                                <img src="<%= book.image %>" alt="<%= book.title %>" class="w-30 h-30 md:w-3/4 md:h-3/4 rounded-lg mx-auto mt-2 mb-2">
                                <span>
                                    <% book.reviews.forEach(review => { %>
                                        <% for (let i = 0; i < review.rating; i++) { %>
                                            <i class="fa-solid fa-star ml-1"></i>
                                        <% } %>
                                    <% }) %>
                                </span>
                            </a>
                        </li>
                    <% }) %>
                </ul>
            </div>
        <% } %>
    <% }) %>
</div>

<%- include('../partials/footer') %>
